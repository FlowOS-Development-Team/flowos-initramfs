#!/bin/bash
#DO NOT EDIT THIS FILE UNLESS YOU ARE A DEVELOPER OR SECURITY AUDITOR, THIS COULD RESULT IN AN IMMEDIATE KERNEL PANIC IF EDITED IMPROPERLY#

# Mount initramfs
mount -t proc proc /proc #mount inital proc fs
mount -t sysfs sysfs /sys #mount inital system filesystem
mount -t devtmpfs devtempfs /dev #mount inital dev filesystem

# NOTE FOR DEVELOPERS; IGNORE IF YOU DON'T KNOW WHAT YOU ARE DOING
# Here if neccessary, you can add kernel modules to be loaded on boot, do not mess with this unless absolutely neccessary (requires modprobe/insmod)
insmod /lib/modules/virtio_blk.ko

#Mount the actual filesystem
#AGAIN, PLEASE DO NOT TOUCH IF YOU DO NOT KNOW WHAT YOU ARE DOING; EDITING THIS IMPROPERLY WILL CALL A KERNEL PANIC!
#mount / /sysroot

# Bypass rootfs and bash into initramfs; DO NOT UNCOMMENT THE LINE BELOW UNLESS YOU KNOW WHAT YOU ARE DOING
#./bin/bash

# Unmount temporary filesystem

#exec switch_root /sysroot /bin/init
mount -o rw /dev/vda1 /root
exec switch_root /root /sbin/init
#umount /proc
#umount /sys
#umount /dev
#exec /bin/bash
# Copyright 2026 Elias Stinson (favoriteone)
# This program is free software: you can redistribute it and/or modify it under the terms of the
# GNU General Public License as published by the Free Software Foundation, either version 3
# of the License, or any later version. This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
# without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
# See the GNU General Public License for more details.
# You should have received a copy of the GNU General Public License along with this program. If not, see <https://www.gnu.org/licenses/>.
